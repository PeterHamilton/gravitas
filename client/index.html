<!DOCTYPE html>
<html>
  <head>
    <title>Gravitas</title>
    <link rel="stylesheet" type="text/css" href="style.css" />

    <!-- Called CoffeeScript.js instead of coffee-script.js for require-cs -->
    <script type="text/javascript" src="js/lib/CoffeeScript.js"></script>
    <script type="text/javascript" src="js/lib/raphael.js"></script>
    <script type="text/javascript" src="js/lib/g.raphael.js"></script>
    <script type="text/javascript" src="js/lib/g.pie.js"></script>
    <script type="text/javascript" src="js/lib/g.line.js"></script>
    <script type="text/javascript" src="http://www.exratione.com/assets/date.format.1.2.3.min.js"></script>


    <script type="text/javascript" src="js/lib/jquery.js"></script>
    <script type="text/javascript" src="js/lib/jquery.cookie.js"></script>
    <script type='text/javascript' src='js/lib/knockout.js'></script>
    <script type='text/javascript' src="js/lib/sonic.js"></script>

    <script type='text/coffeescript' src='js/ko-extras.coffee'></script>

    <script type="text/coffeescript" src="js/config.coffee"></script>
    <script type="text/coffeescript" src="js/common/utils.coffee"></script>

    <script type="text/coffeescript" src="js/common/intersect.coffee"></script>

    <script type="text/coffeescript" src="js/crosshair.coffee"></script>
    <script type="text/coffeescript" src="js/countdown_timer.coffee"></script>
    <script type="text/coffeescript" src="js/shield_powerup_view.coffee"></script>
    <script type="text/coffeescript" src="js/health_powerup_view.coffee"></script>
    <script type="text/coffeescript" src="js/turret.coffee"></script>
    <script type="text/coffeescript" src="js/arena.coffee"></script>
    <script type="text/coffeescript" src="js/statistics.coffee"></script>
    <script type="text/coffeescript" src="js/game.coffee"></script>
    <script type="text/coffeescript" src="js/ball_view.coffee"></script>
    <script type="text/coffeescript" src="js/vortex.coffee"></script>
    <script type="text/coffeescript" src="js/spinners.coffee"></script>
    <script type="text/coffeescript" src="main.coffee"></script>

    <script data-main="js/main" src="js/lib/require.js"></script>

    <script type="text/javascript" src="http://localhost:8001/vogue-client.js"></script>
  </head>

  <body>

    <div id="app" class="hidden-on-startup">

      <!-- Menu: Login, Lobby and Assembly -->
      <div id="menu" class="screen" data-bind="fadeVisible: !gameStarted()">

        <!-- Login window -->
        <div class="window centered-table" data-bind="fadeVisible: !loggedIn()">
          <div class="centered-table-cell">

            <div id="login-window" class="box">
              <form>
                <div class="logo"></div>
                <p>
                  <label for="userName">Username</label>
                  <input type="text" name="userName" maxlength="32" data-bind="value: username, event: { keypress: resetAuthStatus }, hasfocus: true" />
                </p>

                <p>
                  <label for="password">Password</label>
                  <input type="password" name="password" data-bind="value: password, event: { keypress: resetAuthStatus }" />
                </p>

                <input type="submit" data-bind="click: logIn, value: logInButtonText, css: { error: authFailed }" />
              </form>
            </div>

          </div>
        </div>

        <!-- Lobby window -->
        <div class="window centered-table" data-bind="fadeVisible: lobbyVisible()">
          <div class="centered-table-cell">

            <div id="lobby-window" class="box">
              <div class="logo left"></div>
              <div class="nick">
                <span data-bind="text: username" placeholder="Username"></span>
                <span class="rating" data-bind="style: { color: userRatingColor() }, text: userRating()"></span><br />
                <div id="navigation">
                  <a href="#" class="glow" data-menu="profile" data-bind="click: assemblyGoTo">A</a>
                  <a href="#" class="glow" data-menu="achievements" data-bind="click: assemblyGoTo">s</a>
                  <a href="#" class="glow" data-menu="settings" data-bind="click: assemblyGoTo">C</a>
                  <a href="#" class="glow" data-menu="search" data-bind="click: assemblyGoTo">M</a>
                </div>
              </div>
              <br />
              <div class="lobby-content" data-bind="visible: assemblyContent() == 'settings'">
                <label class="large">Settings</label><br />
                <table>
                  <tbody>
                    <tr>
                      <td><label class="small">Display Name:</label></td>
                      <td data-bind="text: username"></td>
                    </tr>
                    <tr>
                      <td><label class="small">Email address:</label></td>
                      <td>user@email.address</td>
                    </tr>
                    <tr>
                      <td>
                        <br /><label class="large">Profile Picture</label>
                      </td>
                    </tr>
                    <tr>
                      <td><label class="small">Picture URL</label></td>
                      <td><input class="small" type="text" data-bind="value: avatarURL" /></td>
                    </tr>
                    <tr>
                      <td><button>Save new URL</button></td>
                    </tr>
                    <tr>
                     <td><br /><label class="large">Change Password</label></td>
                    </tr>
                    <tr>
                      <td><label class="small">Old Password:</label></td>
                      <td><input class="small" type="password" data-bind="value: oldPasswordInput" /></td>
                    </tr>
                    <tr>
                      <td><label class="small">New Password:</label></td>
                      <td><input class="small" type="password" data-bind="value: newPasswordInput1" /></td>
                    </tr>
                    <tr>
                      <td><label class="small">Confirm Password:</label></td>
                      <td><input class="small" type="password" data-bind="value: newPasswordInput2" /></td>
                    </tr>
                    <tr>
                      <td>
                        <button data-bind="enable: !passwordsMismatch()">
                          Change Password
                        </button>
                      </td>
                      <td>
                        <label type="red" data-bind="visible: passwordsMismatch()">Passwords do not match!</label>
                      </td>
                    </tr>
                  </tbody>
                </table>

              </div>

              <div class="lobby-content" data-bind="visible: assemblyContent() == 'profile'">
                <label class="large">Profile</label><br />
                <div class="profile-picture">
                  <img src="images/ui/placeholder.jpg" data-bind="attr: {src: avatarURL}" class="profile" />
                </div>
                <div class="profile-stats">
                  <table>
                    <tbody>
                      <tr>
                        <td><label class="small">Games Won</label></td>
                        <td data-bind="text: gamesWon()">999</td>
                      </tr>
                      <tr>
                        <td><label class="small">Games Played</label></td>
                        <td data-bind="text: gamesPlayed()">123</td>
                      </tr>
                      <tr>
                        <td><label class="small">Time Played</label></td>
                        <td data-bind="text: timePlayedConverted()">13h 19mins</td>
                      </tr>
                      <tr>
                        <td><label class="small">Win/Loss Ratio</label></td>
                      </tr>
                    </tbody>
                  </table>
                  <div id="piePaper"></div>
                </div>
                <div id="chartPaper"></div>
              </div>

              <!-- Achievements -->
              <div class="lobby-content" data-bind="visible: assemblyContent() == 'achievements'">
                <label class="large">Achievements</label><br />

                <table valign="middle">
                  <tbody>
                    <tr>
                      <td><img src="images/medals/first.png" class="medal" data-bind="css: { achieved: achievementStep() != '' }" /></td>
                      <td><label class="medium">Step Into Gravitas</label></td>
                      <td><label class="small">Win one game.</label></td>
                      <td data-bind="text: achievementStep()"></td>
                    </tr>
                    <tr>
                      <td><img src="images/medals/veteran.png" class="medal" data-bind="css: { achieved: achievementVeteran() != '' }" /></td>
                      <td><label class="medium" type="grey">Veteran</label></td>
                      <td><label class="small">Win 100 games.</label></td>
                      <td data-bind="text: achievementVeteran()"></td>
                    </tr>
                    <tr>
                      <td><img src="images/medals/winner.png" class="medal" data-bind="css: { achieved: achievementWinner() != '' }" /></td>
                      <td><label class="medium" type="grey">Winner</label></td>
                      <td><label class="small">Win more than 50 games and have more wins than losses.</label></td>
                      <td data-bind="text: achievementWinner()"></td>
                    </tr>
                    <tr>
                      <td><img src="images/medals/addict.png" class="medal" data-bind="css: { achieved: achievementHardcore() != '' }" /></td>
                      <td><label class="medium" type="grey">Hardcore</label></td>
                      <td><label class="small">Spend 10 hours playing Gravitas.</label></td>
                      <td data-bind="text: achievementHardcore()"></td>
                    </tr>
                    <tr>
                      <td><img src="images/medals/unlucky.png" class="medal" data-bind="css: { achieved: achievementUnlucky() != '' }" /></td>
                      <td><label class="medium" type="grey">Unlucky</label></td>
                      <td><label class="small">Lose 50 games.</label></td>
                      <td data-bind="text: achievementUnlucky()"></td>
                    </tr>
                  </tbody>
                </table>

              </div>

              <!-- Search Panel -->
              <div class="lobby-content" data-bind="visible: assemblyContent() == 'search'">
                <label class="large">Search</label><br/>
                <span class="caps">Lookup Player</span>
                <input class="small" type="text" placeholder="Search..." data-bind="value: searchUserUsername" />
                <button data-bind="click: searchPlayer">Search</button>
                <div class="search-result" data-bind="visible: searchUserRating() != 0">
                  <div class="search-profile-picture">
                    <img data-bind="attr: {src: searchAvatarURL}" class="profile" type="off" />
                  </div>
                  <div class="search-profile-stats">
                    <table>
                      <tbody>
                        <tr>
                          <td><label class="small">Rating</label></td>
                          <td data-bind="text: searchUserRating()">999</td>
                        </tr>
                        <tr>
                          <td><label class="small">Games Won</label></td>
                          <td data-bind="text: searchGamesWon()">999</td>
                        </tr>
                        <tr>
                          <td><label class="small">Games Played</label></td>
                          <td data-bind="text: searchGamesPlayed()">123</td>
                        </tr>
                        <tr>
                          <td><label class="small">Time Played</label></td>
                          <td data-bind="text: searchTimePlayedConverted()">13h 19mins</td>
                        </tr>
                        <tr>
                          <td><label class="small">Win/Loss Ratio</label></td>
                          <td data-bind="text: searchWinLossRatio()"></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>

              <!-- Buttons -->
              <div class="buttons">
                <button class="playbutton" data-bind="click: assemblyClick">
                  Play
                </button>
              </div>

            </div>
          </div>
        </div>

        <!-- Assembly (where you join a game) -->
        <div class="window centered-table" data-bind="fadeVisible: assemblyVisible()">
          <div class="centered-table-cell">

            <div id="assembly-window" class="box">
              <div class="logo left"></div>
              <div class="nick">
                <span data-bind="text: username" placeholder="Username"></span>
                <span class="rating" data-bind="style: { color: userRatingColor() }, text: userRating()"></span>
                <div id="log_container" style="width: 100px">

                  <form id="chatform">
                     Say: <input class="small" style="width: 100px" type="text" id="chatinput" />
                  </form>
                  <div id="log"></div>
                </div>
              </div>
              <br />
              <div class="spinner"></div>
              <div class="spinner-label">Waiting for four other players</div>
              <div class="assembly-content">

                <table>
                  <thead>
                    <tr>
                      <td><label class="medium">Player</label></td>
                      <td></td>
                      <td><label class="medium">Rating</label></td>
                    </tr>
                  </thead>
                  <tbody data-bind="foreach: connectedPlayers">
                    <tr>
                      <td><img src="images/ui/placeholder.jpg" class="profile small" /></td>
                      <td><span data-bind="text: username"></span></td>
                      <td><span data-bind="text: rating"></span></td>
                    </tr>
                  </tbody>
                </table>
                <br />
                <label class="large">Total connected: <span data-bind="text: connectedPlayers().length"></span></label><br />

              </div>


              <div class="buttons">
                <button data-bind="click: connectNew, enable: canAddAnotherPlayer">
                  Add a player (debug)
                </button>

                <button class="leavebutton" data-bind="click: assemblyExitClick">
                  Leave
                </button>

                <button class="startbutton" data-bind="click: startGame">
                  Start
                </button>
              </div>

            </div>
          </div>
        </div>

      </div>


      <!-- The actual turret game screen -->
      <div id="game" class="screen" data-bind="fadeVisible: gameStarted()">

        <div class="window centered-table">
          <div class="centered-table-cell">
            <div id="paper"></div>
          </div>
        </div>

        <!-- Development / Debugging panel -->
        <div id="dev-panel">

          <div class="divlabel">dev</div>

          <p id="lag_indicator" data-bind="css: { lag: lag }">Lag indicator</p>

          <p>
            <input type="checkbox" data-bind="checked: autoLogIn" />Logged in
          </p>
          <p>
            <input type="checkbox" data-bind="checked: autoStart" />Game Started
          </p>
          <p>
            <input type="checkbox" data-bind="checked: !disableSound()" />Sound
          </p>

          <p>
            Player:
            <input type="radio" class="player" name="player" value="0" data-bind="checked: player" />
            <input type="radio" class="player" name="player" value="1" data-bind="checked: player" />
            <input type="radio" class="player" name="player" value="2" data-bind="checked: player" />
            <input type="radio" class="player" name="player" value="3" data-bind="checked: player" />
          </p>

          <div id="log_container">

            <form id="chatform">
              <input type="text" id="chatinput" />
            </form>

            <div id="log"></div>
          </div>

        </div>

      </div>

    </div>

  </body>

</html>
